<!DOCTYPE html>
<html>
<head>
    <title>Prediksi Macet AI</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
        label { font-weight: bold; }
        input { padding: 5px; margin-bottom: 15px; width: 100%; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #hasil { margin-top: 20px; color: #28a745; }
    </style>
</head>
<body>
    <h1>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-stoplights" viewBox="0 0 16 16">
            <path d="M8 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m0 4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m1.5 2.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
            <path d="M4 2a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2h2c-.167.5-.8 1.6-2 2v2h2c-.167.5-.8 1.6-2 2v2h2c-.167.5-.8 1.6-2 2v1a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-1c-1.2-.4-1.833-1.5-2-2h2V8c-1.2-.4-1.833-1.5-2-2h2V4c-1.2-.4-1.833-1.5-2-2zm2-1a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"/>
        </svg>
        Sistem Prediksi Lalu Lintas
    </h1>
    
    <label>Kecepatan Saat Ini (km/jam):</label><br>
    <input type="number" id="speed" value="30" placeholder="Contoh: 30"><br>
    
    <label>Curah Hujan (mm):</label><br>
    <input type="number" id="rain" value="0" placeholder="0 = Cerah, >10 = Hujan"><br>
    
    <label>Hari Libur? (1=Ya, 0=Tidak):</label><br>
    <input type="number" id="holiday" value="0" placeholder="1 atau 0"><br>
    
    <button onclick="kirimPrediksi()">PREDIKSI SEKARANG</button>
    
    <h2 id="hasil">Hasil: -</h2>

    <script>
        async function kirimPrediksi() {
            let hasilElem = document.getElementById('hasil');
            hasilElem.innerText = "Sedang memproses...";

            let data = {
                speed: document.getElementById('speed').value,
                rain: document.getElementById('rain').value,
                holiday: document.getElementById('holiday').value
            };

            try {
                // Pastikan alamat URL lengkap agar bisa diakses dari mana saja
                let response = await fetch('http://127.0.0.1:5000/predict', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                let result = await response.json();
                
                if (result.error) {
                    hasilElem.innerText = "Error: " + result.error;
                    hasilElem.style.color = "red";
                } else {
                    hasilElem.innerText = "Prediksi Kecepatan Nanti: " + result.prediksi + " km/jam";
                    hasilElem.style.color = "#28a745";
                }
            } catch (error) {
                console.error('Error:', error);
                hasilElem.innerText = "Gagal koneksi ke server Python. Pastikan app.py berjalan!";
                hasilElem.style.color = "red";
            }
        }
    </script>
</body>
</html>